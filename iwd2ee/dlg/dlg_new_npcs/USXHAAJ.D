BEGIN ~USXHAAJ~

IF ~~ THEN BEGIN 0
  SAY @40300
  IF ~~ THEN GOTO 1
END

IF ~~ THEN BEGIN 1
  SAY @40301
  IF ~~ THEN EXTERN ~USREIGJ~ 28
END

IF ~~ THEN BEGIN 2
  SAY @40303
  IF ~~ THEN EXTERN ~USREIGJ~ 29
END

IF ~~ THEN BEGIN 3
  SAY @40305
  IF ~~ THEN EXTERN ~USREIGJ~ 30
  IF ~InParty("USVUNA")
See("USVUNA",0)
!StateCheck("USVUNA", EX_NO_DIALOGUE)~ THEN EXTERN ~USVUNAJ~ 0
  IF ~InParty("USEMMA")
See("USEMMA",0)
!StateCheck("USEMMA", EX_NO_DIALOGUE)~ THEN EXTERN ~USEMMAJ~ 0
  IF ~InParty("USZACK")
See("USZACK",0)
!StateCheck("USZACK", EX_NO_DIALOGUE)~ THEN EXTERN ~USZACKJ~ 0
END

IF ~~ THEN BEGIN 4
  SAY @40309
  IF ~~ THEN EXTERN ~USREIGJ~ 30
END

IF ~~ THEN BEGIN 5
  SAY @40311
  IF ~~ THEN EXIT
END

IF ~~ THEN BEGIN 6
  SAY @40918
  IF ~~ THEN EXTERN ~USZACKJ~ 11
END

IF ~~ THEN BEGIN 7
  SAY @40921
  IF ~~ THEN EXTERN ~USZACKJ~ 13
END

IF ~~ THEN BEGIN 8
  SAY @40923
  IF ~~ THEN EXTERN ~USZACKJ~ 14
END

IF ~~ THEN BEGIN 9
  SAY @40925
  IF ~~ THEN EXTERN ~USZACKJ~ 15
END

IF ~~ THEN BEGIN 10
  SAY @40927
  IF ~~ THEN EXTERN ~USZACKJ~ 16
END

IF ~InParty(Myself)
Global("BANTERUSXHAAJ","GLOBAL",1)~ THEN BEGIN 17
  SAY @40929
  IF ~~ THEN DO ~SetGlobal("DIDBANTERUSXHAAJ1","GLOBAL",1)
SetGlobal("BANTERUSZACKJ","GLOBAL",0)~ EXTERN ~USREIGJ~ 104
END

IF ~~ THEN BEGIN 18
  SAY @40931
  IF ~~ THEN EXTERN ~USREIGJ~ 105
END

IF ~~ THEN BEGIN 19
  SAY @40933
  IF ~~ THEN EXIT
END